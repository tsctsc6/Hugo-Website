+++
date = '2025-05-20T16:36:07+08:00'
draft = false
title = '信息安全概论-数据的加密'
categories = ['Sub Sections']
+++

我们先从最为简单的加密算法开始，研究它有何特点。

## 凯撒密码
简单起见，我们考虑 26 个英文字母，按照字母表顺序排列。假设发送方想要发送的消息为"Hello"，把消息中的每一个字母，按照字母表的顺序，替换为它的下一个字母。"Hello"变为"Ifmmp"。把"Ifmmp"发送给接收方，接受方收到消息后，把消息中的每一个字母，按照字母表的顺序，替换为它的上一个字母。这样就能还原出信息"Hello"。

我们在替换字母的时候，并非只能把字母移动一个，还可以移动两个、三个...

如果我们事先并不知道字母偏移量，能否得出原文呢？能的，兄弟，能的，方法有两种：

1. 字母偏移量的范围，只有 1 ~ 25 ，所以我们可以把每一种情况都试一试，看看能否得出通顺的句子。
1. 在英文中，字母"e"出现的频率最高。如果我们能获取大量的，替换过字母的句子，看看哪个字母出现的频率最高，那么这个字母大概就是与"e"对应。这样就能反推出字母偏移量了。

## 密码学的数学理论基础
香农(Claude Shannon)在1949年发表的论文《保密系统的通信理论》(Communication Theory of Secrecy Systems)中，研究了凯撒密码以及其他加密方法的特点，提出了保密系统的一般数学模型和属性。这篇论文是密码学领域的奠基性文献之一，指明了加密算法的设计方向。

### 密码系统的数学模型
加密的定义：将明文(Plaintext)通过密钥(Key)转换为密文(Ciphertext)。

解密的定义：将密文(Ciphertext)通过密钥(Key)转换为明文(Plaintext)。

明文、密钥和密文的定义：一系列数字。在计算机系统中，一般是字节数组。

### 完美保密(Perfect Secrecy)
香农提出了密码系统的无条件安全性(Unconditional Security)概念：若密文不泄露任何关于明文的信息，则系统具有完美保密性（即使攻击者拥有无限计算资源）。

实现完美保密的条件是：

1. 密钥长度大于等于明文长度；
1. 密钥完全随机且仅使用一次（即一次一密， One-Time Pad ）；
1. 密钥与明文统计独立。

但是这是不实际的，因为：

1. 密钥长度大于等于明文长度，那么保护密钥的代价就要比明文高，有时不太划算。
1. 计算机系统无法生成完全随机数。

### 加密算法的设计方向
香农提出加密算法应满足三个核心原则：

1. 密钥长度要足够长。
1. 混淆：使密钥与密文之间的关系尽可能复杂。
1. 扩散：将明文的统计特性分散到整个密文中。

## 对称加密算法
以上讨论的加密算法有一个特点：加密和解密使用同一个密钥。这些算法称为对称加密(Symmetric Cryptography)算法。现代(2025年)的对称加密算法主要分为分组密码(Block Cipher)和流密码(Stream Cipher)。

分组密码把明文分为若干块加密，若最后一块的明文的长度不够，则通过特殊的算法填充满一块。具体可查看这篇博客：[块加密的工作模式](https://www.ruanx.net/block-cipher-mode/)，另存一份[离线 pdf](references/Block-encryption-mode-of-operation.pdf)。

流密码通过密钥生成一系列随机数。对于每一个明文的字节，取一个随机数与其异或。

目前(2025年)常用的分组密码有： AES-256 ，常用的流密码有： ChaCha20 。

## 非对称加密
我们在前文讨论了对称加密算法，但是在实践中，还有一个难题：通信双方如何确定相同的密钥？为了解决这个问题，有人提出了非对称加密的概念。

非对称加密(Asymmetric Cryptography)，又称公钥加密。它的特点是加密和解密使用的密钥不同，分为公钥和私钥。其中公钥是公开的，所有人可知；私钥由接收方秘密保存。加密和解密的基本流程是：

1. 接收方设定私钥，通过算法生成公钥，将其公布。
1. 发送方使用公钥加密明文，发送密文。
1. 接收方使用私钥解密密文。

这样，不用事先交换对称密钥也能进行加密通信了。但需要注意的是，非对称加密算法的开销比较大，在需要加密大量数据时，先使用非对称加密同步对称加密密钥，然后使用对称加密发送消息。

目前(2025年)常用的非对称加密算法有： RSA, ECC, Diffie-Hellman 。

### 非对称加密的设计方向
非对称加密的安全性依赖于计算复杂性理论，其设计必须基于一类正向容易逆向困难的数学难题，使得：

1. 正向计算容易：私钥容易计算出公钥。
1. 逆向破解困难：公钥难以计算出私钥。

典型的数学难题有：

1. 大整数的质因数分解问题。
1. 离散对数问题。
1. 椭圆曲线离散对数问题。

如果数学难题被解决，那么对应的非对称加密算法将不再安全。
